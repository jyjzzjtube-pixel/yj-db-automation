<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YJ DB ìë™í™” â€” ì¢…í•© í…ŒìŠ¤íŠ¸</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,'Pretendard','Noto Sans KR',sans-serif;background:#f5f5f5;color:#333;padding:20px;font-size:14px;line-height:1.6}
h1{font-size:24px;margin-bottom:4px;color:#C0392B}
.sub{color:#888;font-size:12px;margin-bottom:20px}
.section{background:#fff;border-radius:14px;padding:20px;margin-bottom:16px;box-shadow:0 2px 12px rgba(0,0,0,.06)}
.section h2{font-size:16px;font-weight:800;margin-bottom:12px;padding-bottom:8px;border-bottom:2px solid #f0f0f0;display:flex;align-items:center;gap:8px}
.test-row{display:flex;align-items:center;gap:10px;padding:8px 12px;border-radius:8px;margin-bottom:4px;background:#fafafa;font-size:13px}
.test-row:hover{background:#f0f0f0}
.test-name{flex:1;font-weight:600}
.test-status{padding:3px 10px;border-radius:20px;font-size:11px;font-weight:700;min-width:60px;text-align:center}
.pass{background:#E8F5E9;color:#2E7D32}
.fail{background:#FFEBEE;color:#C62828}
.skip{background:#FFF3E0;color:#E65100}
.pending{background:#E3F2FD;color:#1565C0}
.run-btn{padding:6px 16px;background:#C0392B;color:#fff;border:none;border-radius:8px;font-weight:700;font-size:12px;cursor:pointer;transition:.2s}
.run-btn:hover{background:#a93226;transform:translateY(-1px)}
.run-btn:disabled{background:#ccc;cursor:not-allowed}
.summary{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:20px}
.summary-card{background:#fff;border-radius:12px;padding:16px;text-align:center;box-shadow:0 2px 8px rgba(0,0,0,.04)}
.summary-num{font-size:28px;font-weight:800}
.summary-label{font-size:11px;color:#888;font-weight:600;letter-spacing:1px;text-transform:uppercase}
.log{background:#1a1a2e;color:#e0e0e0;border-radius:10px;padding:14px;font-family:'Consolas','Monaco',monospace;font-size:11px;max-height:300px;overflow-y:auto;margin-top:12px;line-height:1.8}
.log .ok{color:#4CAF50}.log .err{color:#F44336}.log .warn{color:#FF9800}.log .info{color:#64B5F6}
.inject-btn{padding:10px 20px;background:#1565C0;color:#fff;border:none;border-radius:10px;font-weight:700;font-size:14px;cursor:pointer;margin-right:8px;transition:.2s}
.inject-btn:hover{background:#0D47A1;transform:translateY(-1px)}
.progress{height:6px;background:#eee;border-radius:3px;margin-top:8px;overflow:hidden}
.progress-bar{height:100%;background:linear-gradient(90deg,#4CAF50,#8BC34A);border-radius:3px;transition:width .5s;width:0}
</style>
</head>
<body>

<h1>ğŸ§ª YJ DB ìë™í™” â€” ì¢…í•© í…ŒìŠ¤íŠ¸</h1>
<p class="sub">ëª¨ë“  ê¸°ëŠ¥ì„ ìë™ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤. index.htmlê³¼ ë™ì¼í•œ localStorage(udb6)ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>

<div class="summary">
  <div class="summary-card"><div class="summary-num" id="totalTests" style="color:#333">0</div><div class="summary-label">ì „ì²´ í…ŒìŠ¤íŠ¸</div></div>
  <div class="summary-card"><div class="summary-num" id="passCount" style="color:#2E7D32">0</div><div class="summary-label">âœ… í†µê³¼</div></div>
  <div class="summary-card"><div class="summary-num" id="failCount" style="color:#C62828">0</div><div class="summary-label">âŒ ì‹¤íŒ¨</div></div>
  <div class="summary-card"><div class="summary-num" id="skipCount" style="color:#E65100">0</div><div class="summary-label">âš ï¸ ê±´ë„ˆëœ€</div></div>
</div>

<div style="display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap">
  <button class="run-btn" onclick="runAllTests()" id="runAllBtn" style="font-size:14px;padding:10px 28px">â–¶ ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
  <button class="inject-btn" onclick="injectTestData()">ğŸ“¥ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì£¼ì…</button>
  <button class="inject-btn" onclick="clearTestData()" style="background:#C62828">ğŸ—‘ï¸ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚­ì œ</button>
  <button class="inject-btn" onclick="window.open('index.html','_blank')" style="background:#333">ğŸ“± ì•± ì—´ê¸°</button>
</div>
<div class="progress"><div class="progress-bar" id="progressBar"></div></div>

<!-- 1. í•µì‹¬ ìœ í‹¸ë¦¬í‹° -->
<div class="section">
  <h2>ğŸ”§ í•µì‹¬ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜</h2>
  <div id="testUtil"></div>
</div>

<!-- 2. ìŠ¤ë§ˆíŠ¸ ì…ë ¥ -->
<div class="section">
  <h2>ğŸ“ ìŠ¤ë§ˆíŠ¸ ì…ë ¥ (ìë™ ë¶„ë¥˜)</h2>
  <div id="testSmart"></div>
</div>

<!-- 3. ê³ ê° CRUD -->
<div class="section">
  <h2>ğŸ‘¥ ê³ ê° DB CRUD</h2>
  <div id="testCust"></div>
</div>

<!-- 4. ì í¬ CRUD -->
<div class="section">
  <h2>ğŸª ì í¬ DB CRUD</h2>
  <div id="testStore"></div>
</div>

<!-- 5. ë¸Œëœë“œ CRUD -->
<div class="section">
  <h2>ğŸ· ë¸Œëœë“œ DB</h2>
  <div id="testBrand"></div>
</div>

<!-- 6. ê²€ìƒ‰ -->
<div class="section">
  <h2>ğŸ” í†µí•© ê²€ìƒ‰</h2>
  <div id="testSearch"></div>
</div>

<!-- 7. SMS -->
<div class="section">
  <h2>ğŸ“© SMS ë¬¸ì ë°œì†¡</h2>
  <div id="testSMS"></div>
</div>

<!-- 8. ë°ì´í„° ê´€ë¦¬ -->
<div class="section">
  <h2>ğŸ’¾ ë°ì´í„° ê´€ë¦¬</h2>
  <div id="testData"></div>
</div>

<!-- 9. UI/UX -->
<div class="section">
  <h2>ğŸ¨ UI/UX</h2>
  <div id="testUI"></div>
</div>

<!-- ë¡œê·¸ -->
<div class="section">
  <h2>ğŸ“‹ í…ŒìŠ¤íŠ¸ ë¡œê·¸</h2>
  <div class="log" id="testLog">í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì „ì…ë‹ˆë‹¤...</div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//   í…ŒìŠ¤íŠ¸ ì—”ì§„
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let results = { total: 0, pass: 0, fail: 0, skip: 0 };
let logLines = [];

function log(msg, type='info') {
  logLines.push(`<span class="${type}">[${type.toUpperCase()}] ${msg}</span>`);
  document.getElementById('testLog').innerHTML = logLines.join('<br>');
  document.getElementById('testLog').scrollTop = 99999;
}

function assert(name, fn, containerId) {
  results.total++;
  let status, statusClass;
  try {
    const result = fn();
    if (result === 'skip') {
      results.skip++;
      status = 'ê±´ë„ˆëœ€';
      statusClass = 'skip';
      log(`âš ï¸ ${name} â€” ê±´ë„ˆëœ€`, 'warn');
    } else if (result) {
      results.pass++;
      status = 'âœ… í†µê³¼';
      statusClass = 'pass';
      log(`âœ… ${name}`, 'ok');
    } else {
      results.fail++;
      status = 'âŒ ì‹¤íŒ¨';
      statusClass = 'fail';
      log(`âŒ ${name}`, 'err');
    }
  } catch (e) {
    results.fail++;
    status = 'âŒ ì˜¤ë¥˜';
    statusClass = 'fail';
    log(`âŒ ${name}: ${e.message}`, 'err');
  }
  document.getElementById(containerId).innerHTML +=
    `<div class="test-row"><span class="test-name">${name}</span><span class="test-status ${statusClass}">${status}</span></div>`;
  updateSummary();
}

function updateSummary() {
  document.getElementById('totalTests').textContent = results.total;
  document.getElementById('passCount').textContent = results.pass;
  document.getElementById('failCount').textContent = results.fail;
  document.getElementById('skipCount').textContent = results.skip;
  const pct = results.total ? Math.round((results.pass / results.total) * 100) : 0;
  document.getElementById('progressBar').style.width = pct + '%';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//   í…ŒìŠ¤íŠ¸ìš© ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ (index.htmlì—ì„œ ë³µì‚¬)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const numVal = v => {
  if(!v) return 0;
  const s = String(v).replace(/[, ]/g,'');
  const m = s.match(/(\d+)\s*ì–µ\s*(\d*)\s*(ì²œë§Œ|ë§Œ)?/);
  if(m) { let r = parseInt(m[1])*1e8; if(m[2]&&m[3]==='ì²œë§Œ') r+=parseInt(m[2])*1e7; else if(m[2]&&m[3]==='ë§Œ') r+=parseInt(m[2])*1e4; else if(m[2]) r+=parseInt(m[2])*1e4; return r; }
  const m2 = s.match(/(\d+)\s*ì²œë§Œ/); if(m2) return parseInt(m2[1])*1e7;
  const m3 = s.match(/(\d+)\s*ë§Œ/); if(m3) return parseInt(m3[1])*1e4;
  return parseInt(s)||0;
};

const fW = n => {
  if(!n && n!==0) return '';
  const v = typeof n==='string' ? parseInt(n.replace(/[, ]/g,'')) : n;
  if(isNaN(v)||v===0) return '';
  if(v>=1e8) return (v/1e8).toFixed(1).replace(/\.0$/,'')+'ì–µ';
  if(v>=1e4) return Math.round(v/1e4)+'ë§Œ';
  return v.toLocaleString();
};

const esc = s => (s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
const today = () => new Date().toISOString().slice(0,10);
const PHONE_RE = /\d{2,3}-\d{3,4}-\d{4}/;

// ìŠ¤ë§ˆíŠ¸ ì…ë ¥ ìë™ ë¶„ë¥˜ ë¡œì§
function classifyInput(text) {
  const lines = text.split('\n').filter(l => l.trim());
  const storeKW = /í‰|ì„ëŒ€|ì›”ì„¸|ë³´ì¦ê¸ˆ|ê¶Œë¦¬ê¸ˆ|ê´€ë¦¬ë¹„|ê³µì‹¤|ì í¬|ë§¤ë¬¼|ìƒê°€|ì¸µ/;
  const brandKW = /ë³¸ì‚¬|ê°€ë§¹|í”„ëœì°¨ì´ì¦ˆ|ë¸Œëœë“œ|FC|ì°½ì—…ë¹„ìš©|ë¡œì—´í‹°|ê°€ë§¹ë¹„/;
  const results = [];
  lines.forEach(line => {
    if (storeKW.test(line)) results.push({ type: 'store', text: line });
    else if (brandKW.test(line)) results.push({ type: 'brand', text: line });
    else results.push({ type: 'customer', text: line });
  });
  return results;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//   ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function runAllTests() {
  const btn = document.getElementById('runAllBtn');
  btn.disabled = true; btn.textContent = 'â³ í…ŒìŠ¤íŠ¸ ì¤‘...';

  // ì´ˆê¸°í™”
  results = { total: 0, pass: 0, fail: 0, skip: 0 };
  logLines = [];
  document.querySelectorAll('[id^="test"]').forEach(el => { if(el.id !== 'testLog') el.innerHTML = ''; });
  log('â•â•â• í…ŒìŠ¤íŠ¸ ì‹œì‘ â•â•â•', 'info');
  log('ì‹œê°„: ' + new Date().toLocaleString('ko-KR'), 'info');

  // 1. í•µì‹¬ ìœ í‹¸ë¦¬í‹° í…ŒìŠ¤íŠ¸
  testUtilities();
  await sleep(50);

  // 2. ìŠ¤ë§ˆíŠ¸ ì…ë ¥ í…ŒìŠ¤íŠ¸
  testSmartInput();
  await sleep(50);

  // 3. ê³ ê° CRUD í…ŒìŠ¤íŠ¸
  testCustomerCRUD();
  await sleep(50);

  // 4. ì í¬ CRUD í…ŒìŠ¤íŠ¸
  testStoreCRUD();
  await sleep(50);

  // 5. ë¸Œëœë“œ í…ŒìŠ¤íŠ¸
  testBrandCRUD();
  await sleep(50);

  // 6. ê²€ìƒ‰ í…ŒìŠ¤íŠ¸
  testSearch();
  await sleep(50);

  // 7. SMS í…ŒìŠ¤íŠ¸
  testSMS();
  await sleep(50);

  // 8. ë°ì´í„° ê´€ë¦¬ í…ŒìŠ¤íŠ¸
  testDataManagement();
  await sleep(50);

  // 9. UI í…ŒìŠ¤íŠ¸
  testUIUX();

  // ì™„ë£Œ
  log('', 'info');
  log('â•â•â• í…ŒìŠ¤íŠ¸ ì™„ë£Œ â•â•â•', 'info');
  log(`ì „ì²´: ${results.total} | í†µê³¼: ${results.pass} | ì‹¤íŒ¨: ${results.fail} | ê±´ë„ˆëœ€: ${results.skip}`, results.fail ? 'err' : 'ok');
  log(`í†µê³¼ìœ¨: ${results.total ? Math.round((results.pass/results.total)*100) : 0}%`, results.fail ? 'err' : 'ok');

  btn.disabled = false; btn.textContent = 'â–¶ ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰';
}

function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//   1. ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ í…ŒìŠ¤íŠ¸
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function testUtilities() {
  log('â”€â”€ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ í…ŒìŠ¤íŠ¸ â”€â”€', 'info');

  assert('numVal: "350ë§Œ" â†’ 3500000', () => numVal('350ë§Œ') === 3500000, 'testUtil');
  assert('numVal: "5ì²œë§Œ" â†’ 50000000', () => numVal('5ì²œë§Œ') === 50000000, 'testUtil');
  assert('numVal: "1ì–µ2ì²œë§Œ" â†’ 120000000', () => numVal('1ì–µ2ì²œë§Œ') === 120000000, 'testUtil');
  assert('numVal: "8ì²œë§Œ" â†’ 80000000', () => numVal('8ì²œë§Œ') === 80000000, 'testUtil');
  assert('numVal: "1ì–µ" â†’ 100000000', () => numVal('1ì–µ') === 100000000, 'testUtil');
  assert('numVal: "7820ë§Œ" â†’ 78200000', () => numVal('7820ë§Œ') === 78200000, 'testUtil');
  assert('numVal: "" â†’ 0', () => numVal('') === 0, 'testUtil');
  assert('numVal: null â†’ 0', () => numVal(null) === 0, 'testUtil');

  assert('fW: 100000000 â†’ "1ì–µ"', () => fW(100000000) === '1ì–µ', 'testUtil');
  assert('fW: 50000000 â†’ "5000ë§Œ"', () => fW(50000000) === '5000ë§Œ', 'testUtil');
  assert('fW: 3500000 â†’ "350ë§Œ"', () => fW(3500000) === '350ë§Œ', 'testUtil');
  assert('fW: 0 â†’ ""', () => fW(0) === '', 'testUtil');

  assert('esc: HTML ì´ìŠ¤ì¼€ì´í”„', () => esc('<script>') === '&lt;script&gt;', 'testUtil');
  assert('esc: ë”°ì˜´í‘œ ì´ìŠ¤ì¼€ì´í”„', () => esc('"hello"') === '&quot;hello&quot;', 'testUtil');
  assert('esc: null â†’ ""', () => esc(null) === '', 'testUtil');

  assert('today: YYYY-MM-DD í˜•ì‹', () => /^\d{4}-\d{2}-\d{2}$/.test(today()), 'testUtil');
  assert('PHONE_RE: 010-1234-5678 ë§¤ì¹­', () => PHONE_RE.test('010-1234-5678'), 'testUtil');
  assert('PHONE_RE: ì˜ëª»ëœ í˜•ì‹ ë¯¸ë§¤ì¹­', () => !PHONE_RE.test('12345'), 'testUtil');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//   2. ìŠ¤ë§ˆíŠ¸ ì…ë ¥ í…ŒìŠ¤íŠ¸
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function testSmartInput() {
  log('â”€â”€ ìŠ¤ë§ˆíŠ¸ ì…ë ¥ í…ŒìŠ¤íŠ¸ â”€â”€', 'info');

  assert('ê³ ê° ë¶„ë¥˜: ì´ë¦„+ì—°ë½ì²˜', () => {
    const r = classifyInput('ê¹€ì² ìˆ˜ 010-1234-5678 VIP ê°•ë‚¨ ì¹´í˜');
    return r.length === 1 && r[0].type === 'customer';
  }, 'testSmart');

  assert('ì í¬ ë¶„ë¥˜: í‰ìˆ˜+ì„ëŒ€', () => {
    const r = classifyInput('ê°•ë‚¨ì—­ 2ë²ˆì¶œêµ¬ 35í‰ ì„ëŒ€ 350ë§Œ');
    return r.length === 1 && r[0].type === 'store';
  }, 'testSmart');

  assert('ë¸Œëœë“œ ë¶„ë¥˜: ë³¸ì‚¬+ê°€ë§¹', () => {
    const r = classifyInput('ë§˜ìŠ¤í„°ì¹˜ ë³¸ì‚¬ ë‹´ë‹¹ ì´ë¶€ì¥ ê°€ë§¹ì¡°ê±´ ë¬¸ì˜');
    return r.length === 1 && r[0].type === 'brand';
  }, 'testSmart');

  assert('ë©€í‹°ë¼ì¸ ë¶„ë¥˜: 3ì¢… ë™ì‹œ', () => {
    const input = 'ê¹€ì² ìˆ˜ 010-1234-5678 VIP\nê°•ë‚¨ì—­ 35í‰ ì„ëŒ€ 350ë§Œ\në§˜ìŠ¤í„°ì¹˜ ë³¸ì‚¬ ê°€ë§¹ ë¬¸ì˜';
    const r = classifyInput(input);
    return r.length === 3 && r[0].type === 'customer' && r[1].type === 'store' && r[2].type === 'brand';
  }, 'testSmart');

  assert('ë¹ˆ ì…ë ¥ ì²˜ë¦¬', () => {
    const r = classifyInput('');
    return r.length === 0;
  }, 'testSmart');

  assert('ì í¬ í‚¤ì›Œë“œ: ë³´ì¦ê¸ˆ', () => {
    const r = classifyInput('ë³´ì¦ê¸ˆ 5ì²œë§Œ ê¶Œë¦¬ê¸ˆ 8ì²œë§Œ');
    return r[0].type === 'store';
  }, 'testSmart');

  assert('ì í¬ í‚¤ì›Œë“œ: ê³µì‹¤', () => {
    const r = classifyInput('ì—­ì‚¼ë™ ê³µì‹¤ 1ì¸µ');
    return r[0].type === 'store';
  }, 'testSmart');

  assert('ë¸Œëœë“œ í‚¤ì›Œë“œ: í”„ëœì°¨ì´ì¦ˆ', () => {
    const r = classifyInput('ë¹½ë‹¤ë°© í”„ëœì°¨ì´ì¦ˆ ì°½ì—…ë¹„ìš© ë¬¸ì˜');
    return r[0].type === 'brand';
  }, 'testSmart');

  assert('ì—°ë½ì²˜ íŒŒì‹±: 010-XXXX-XXXX', () => {
    return PHONE_RE.test('010-1234-5678') && PHONE_RE.test('02-123-4567');
  }, 'testSmart');

  assert('íƒœê·¸ íŒŒì‹±: #ê¸‰ë§¤ #ì—­ì„¸ê¶Œ', () => {
    const tags = '#ê¸‰ë§¤ #ì—­ì„¸ê¶Œ ì¼ë°˜ í…ìŠ¤íŠ¸'.match(/#\S+/g);
    return tags && tags.length === 2 && tags[0] === '#ê¸‰ë§¤' && tags[1] === '#ì—­ì„¸ê¶Œ';
  }, 'testSmart');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//   3. ê³ ê° CRUD í…ŒìŠ¤íŠ¸
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function testCustomerCRUD() {
  log('â”€â”€ ê³ ê° CRUD í…ŒìŠ¤íŠ¸ â”€â”€', 'info');

  // localStorageì—ì„œ í˜„ì¬ ë°ì´í„° ë¡œë“œ
  let data;
  try { data = JSON.parse(localStorage.getItem('udb6')) || {}; } catch { data = {}; }

  assert('localStorage ì½ê¸°', () => {
    return typeof data === 'object';
  }, 'testCust');

  assert('ê³ ê° ë°°ì—´ ì¡´ì¬', () => {
    return Array.isArray(data.customers);
  }, 'testCust');

  assert('ê³ ê° ë°ì´í„° êµ¬ì¡° í™•ì¸', () => {
    if (!data.customers || !data.customers.length) return 'skip';
    const c = data.customers[0];
    return c.hasOwnProperty('id') && c.hasOwnProperty('name');
  }, 'testCust');

  assert('ê³ ê° ë“±ê¸‰ ê°’ ìœ íš¨ì„±', () => {
    if (!data.customers || !data.customers.length) return 'skip';
    const validGrades = ['VIP','ìš°ìˆ˜','ì¼ë°˜','ì‹ ê·œ','íœ´ë©´',''];
    return data.customers.every(c => validGrades.includes(c.grade || ''));
  }, 'testCust');

  assert('ê³ ê° ìƒíƒœ ê°’ ìœ íš¨ì„±', () => {
    if (!data.customers || !data.customers.length) return 'skip';
    const validStatus = ['ì‹ ê·œ','ìƒë‹´ì¤‘','ê³„ì•½ì§„í–‰','ê³„ì•½ì™„ë£Œ','ì´íƒˆ','ì œì•ˆì™„ë£Œ','ë³´ë¥˜','í•´ì§€',''];
    return data.customers.every(c => validStatus.includes(c.status || ''));
  }, 'testCust');

  assert('ê³ ê° ID ê³ ìœ ì„± í™•ì¸', () => {
    if (!data.customers || !data.customers.length) return 'skip';
    const ids = data.customers.map(c => c.id);
    return new Set(ids).size === ids.length;
  }, 'testCust');

  assert('ê³ ê° ì—°ë½ì²˜ í˜•ì‹', () => {
    if (!data.customers || !data.customers.length) return 'skip';
    const withPhone = data.customers.filter(c => c.phone);
    if (!withPhone.length) return 'skip';
    return withPhone.every(c => /^\d{2,3}-\d{3,4}-\d{4}$/.test(c.phone));
  }, 'testCust');

  assert('ê³ ê° ì¹´í…Œê³ ë¦¬ ë°°ì—´ ì¡´ì¬', () => {
    return Array.isArray(data.custCats);
  }, 'testCust');

  assert('ê³ ê° ë©”ëª¨ êµ¬ì¡°', () => {
    if (!data.customers || !data.customers.length) return 'skip';
    const withMemos = data.customers.filter(c => c.memos && c.memos.length);
    if (!withMemos.length) return 'skip';
    return withMemos[0].memos[0].hasOwnProperty('text');
  }, 'testCust');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//   4. ì í¬ CRUD í…ŒìŠ¤íŠ¸
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function testStoreCRUD() {
  log('â”€â”€ ì í¬ CRUD í…ŒìŠ¤íŠ¸ â”€â”€', 'info');

  let data;
  try { data = JSON.parse(localStorage.getItem('udb6')) || {}; } catch { data = {}; }

  assert('ì í¬ ë°°ì—´ ì¡´ì¬', () => Array.isArray(data.stores), 'testStore');

  assert('ì í¬ ë°ì´í„° êµ¬ì¡°', () => {
    if (!data.stores || !data.stores.length) return 'skip';
    const s = data.stores[0];
    return s.hasOwnProperty('id') && s.hasOwnProperty('name');
  }, 'testStore');

  assert('ì í¬ ë“±ê¸‰ ê°’ ìœ íš¨ì„±', () => {
    if (!data.stores || !data.stores.length) return 'skip';
    const valid = ['Aê¸‰','Bê¸‰','Cê¸‰','ë¯¸ì •',''];
    return data.stores.every(s => valid.includes(s.grade || ''));
  }, 'testStore');

  assert('ì í¬ ì„ëŒ€ë£Œ numVal ë³€í™˜', () => {
    if (!data.stores || !data.stores.length) return 'skip';
    const withRent = data.stores.filter(s => s.rent);
    if (!withRent.length) return 'skip';
    return numVal(withRent[0].rent) > 0;
  }, 'testStore');

  assert('ì í¬ ì‹œì„¸ ë¹„êµ ê³„ì‚°', () => {
    const rent = numVal('350ë§Œ');
    const market = numVal('300ë§Œ');
    const diff = rent - market;
    const pct = Math.round((diff / market) * 100);
    return diff === 500000 && pct === 17;
  }, 'testStore');

  assert('ì í¬ ì›”ì´ë¹„ìš© ê³„ì‚°', () => {
    const rent = numVal('350ë§Œ');
    const maint = numVal('30ë§Œ');
    const total = rent + maint;
    return total === 3800000;
  }, 'testStore');

  assert('ì í¬ ì¹´í…Œê³ ë¦¬ ë°°ì—´ ì¡´ì¬', () => {
    return Array.isArray(data.storeCats);
  }, 'testStore');

  assert('ì í¬ ID ê³ ìœ ì„± í™•ì¸', () => {
    if (!data.stores || !data.stores.length) return 'skip';
    const ids = data.stores.map(s => s.id);
    return new Set(ids).size === ids.length;
  }, 'testStore');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//   5. ë¸Œëœë“œ í…ŒìŠ¤íŠ¸
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function testBrandCRUD() {
  log('â”€â”€ ë¸Œëœë“œ í…ŒìŠ¤íŠ¸ â”€â”€', 'info');

  let data;
  try { data = JSON.parse(localStorage.getItem('udb6')) || {}; } catch { data = {}; }

  assert('ë¸Œëœë“œ ë°°ì—´ ì¡´ì¬', () => Array.isArray(data.brands), 'testBrand');

  assert('ë¸Œëœë“œ ë°ì´í„° êµ¬ì¡°', () => {
    if (!data.brands || !data.brands.length) return 'skip';
    const b = data.brands[0];
    return b.hasOwnProperty('id') && b.hasOwnProperty('brandName');
  }, 'testBrand');

  assert('ë¸Œëœë“œ ID ê³ ìœ ì„±', () => {
    if (!data.brands || !data.brands.length) return 'skip';
    const ids = data.brands.map(b => b.id);
    return new Set(ids).size === ids.length;
  }, 'testBrand');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//   6. ê²€ìƒ‰ í…ŒìŠ¤íŠ¸
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function testSearch() {
  log('â”€â”€ ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ â”€â”€', 'info');

  let data;
  try { data = JSON.parse(localStorage.getItem('udb6')) || {}; } catch { data = {}; }

  function searchCustomers(q) {
    return (data.customers||[]).filter(c => {
      const t = (c.name||'')+(c.phone||'')+(c.region||'')+(c.bizType||'')+(c.interests||'')+(c.budget||'')+(c.wantArea||'')+(c.grade||'')+(c.status||'')+(c.dbCat||'');
      return t.toLowerCase().includes(q.toLowerCase());
    });
  }

  assert('ê³ ê° ì´ë¦„ ê²€ìƒ‰', () => {
    if (!data.customers || !data.customers.length) return 'skip';
    const name = data.customers[0].name;
    return searchCustomers(name).length >= 1;
  }, 'testSearch');

  assert('ë¹ˆ ê²€ìƒ‰ì–´ â†’ ì „ì²´ ë°˜í™˜', () => {
    return searchCustomers('').length === (data.customers||[]).length;
  }, 'testSearch');

  assert('ì—†ëŠ” ê²€ìƒ‰ì–´ â†’ 0ê±´', () => {
    return searchCustomers('zzzzzzzzz12345').length === 0;
  }, 'testSearch');

  function searchStores(q) {
    return (data.stores||[]).filter(s => {
      const t = (s.name||'')+(s.address||'')+(s.district||'')+(s.rent||'')+(s.deposit||'')+(s.premium||'')+(s.grade||'')+(s.status||'');
      return t.toLowerCase().includes(q.toLowerCase());
    });
  }

  assert('ì í¬ ê²€ìƒ‰ ê¸°ëŠ¥', () => {
    if (!data.stores || !data.stores.length) return 'skip';
    const name = data.stores[0].name;
    return searchStores(name).length >= 1;
  }, 'testSearch');

  assert('ëŒ€ì†Œë¬¸ì ë¬´ì‹œ ê²€ìƒ‰', () => {
    return searchCustomers('vip').length === searchCustomers('VIP').length;
  }, 'testSearch');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//   7. SMS í…ŒìŠ¤íŠ¸
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function testSMS() {
  log('â”€â”€ SMS í…ŒìŠ¤íŠ¸ â”€â”€', 'info');

  let data;
  try { data = JSON.parse(localStorage.getItem('udb6')) || {}; } catch { data = {}; }

  assert('ì•Œë¦¬ê³  API Key í•„ë“œ', () => {
    return data.hasOwnProperty('aligoKey');
  }, 'testSMS');

  assert('ì•Œë¦¬ê³  ì‚¬ìš©ì ID í•„ë“œ', () => {
    return data.hasOwnProperty('aligoId');
  }, 'testSMS');

  assert('ì•Œë¦¬ê³  ë°œì‹ ë²ˆí˜¸ í•„ë“œ', () => {
    return data.hasOwnProperty('aligoSender');
  }, 'testSMS');

  assert('í…ŒìŠ¤íŠ¸ëª¨ë“œ ê¸°ë³¸ê°’ Y', () => {
    return (data.aligoTest || 'Y') === 'Y' || data.aligoTest === 'N';
  }, 'testSMS');

  assert('[ì´ë¦„] ì¹˜í™˜ ë¡œì§', () => {
    const msg = '[ì´ë¦„]ë‹˜ ì•ˆë…•í•˜ì„¸ìš”! ì¢‹ì€ ë§¤ë¬¼ì´ ìˆìŠµë‹ˆë‹¤.';
    const name = 'ê¹€ì² ìˆ˜';
    const result = msg.replace(/\[ì´ë¦„\]/g, name);
    return result === 'ê¹€ì² ìˆ˜ë‹˜ ì•ˆë…•í•˜ì„¸ìš”! ì¢‹ì€ ë§¤ë¬¼ì´ ìˆìŠµë‹ˆë‹¤.';
  }, 'testSMS');

  assert('SMS/LMS ìë™ íŒë³„ (45ì ê¸°ì¤€)', () => {
    const short = 'ì•ˆë…•í•˜ì„¸ìš” í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ì…ë‹ˆë‹¤';
    const long = 'ì•ˆë…•í•˜ì„¸ìš”! ì´ë²ˆì— ì¢‹ì€ í”„ëœì°¨ì´ì¦ˆ ë§¤ë¬¼ì´ ìƒˆë¡œ ë‚˜ì™”ìŠµë‹ˆë‹¤. ê°•ë‚¨ì—­ ì¸ê·¼ 35í‰ ì¹´í˜ë¡œ, ì›”ì„ëŒ€ 350ë§Œì›ì— ë³´ì¦ê¸ˆ 5ì²œë§Œì›ì…ë‹ˆë‹¤. ê´€ì‹¬ ìˆìœ¼ì‹œë©´ ì—°ë½ì£¼ì„¸ìš”!';
    return short.length <= 45 && long.length > 45;
  }, 'testSMS');

  assert('ë°œì†¡ ì´ë ¥ ë°°ì—´', () => {
    return Array.isArray(data.smsHistory || []);
  }, 'testSMS');

  assert('CORS í”„ë¡ì‹œ ì„¤ì • ì¡´ì¬', () => {
    const proxy = data.aligoProxy || 'direct';
    return ['direct', 'allorigins', 'corsproxy'].includes(proxy);
  }, 'testSMS');

  assert('SMS URI ìŠ¤í‚´ ìƒì„±', () => {
    const phone = '010-1234-5678';
    const msg = 'í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€';
    const uri = 'sms:' + phone + '?body=' + encodeURIComponent(msg);
    return uri.startsWith('sms:010-1234-5678?body=');
  }, 'testSMS');

  assert('ëŒ€ëŸ‰ë°œì†¡ rec_N/msg_N íŒŒë¼ë¯¸í„° ìƒì„±', () => {
    const sel = [{name:'ê¹€ì² ìˆ˜',phone:'010-1234-5678'},{name:'ì´ì˜í¬',phone:'010-9876-5432'}];
    const body = new URLSearchParams();
    body.append('cnt', sel.length);
    sel.forEach((c,i) => {
      body.append('rec_'+(i+1), c.phone.replace(/-/g,''));
      body.append('msg_'+(i+1), 'í…ŒìŠ¤íŠ¸ '+c.name);
    });
    return body.get('cnt') === '2' && body.get('rec_1') === '01012345678' && body.get('msg_2') === 'í…ŒìŠ¤íŠ¸ ì´ì˜í¬';
  }, 'testSMS');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//   8. ë°ì´í„° ê´€ë¦¬ í…ŒìŠ¤íŠ¸
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function testDataManagement() {
  log('â”€â”€ ë°ì´í„° ê´€ë¦¬ í…ŒìŠ¤íŠ¸ â”€â”€', 'info');

  assert('localStorage ì½ê¸°/ì“°ê¸°', () => {
    const testKey = '_test_yj_' + Date.now();
    localStorage.setItem(testKey, 'ok');
    const val = localStorage.getItem(testKey);
    localStorage.removeItem(testKey);
    return val === 'ok';
  }, 'testData');

  assert('JSON ì§ë ¬í™”/ì—­ì§ë ¬í™”', () => {
    const obj = { name: 'í…ŒìŠ¤íŠ¸', arr: [1,2,3], nested: { a: true } };
    const json = JSON.stringify(obj);
    const parsed = JSON.parse(json);
    return parsed.name === 'í…ŒìŠ¤íŠ¸' && parsed.arr.length === 3 && parsed.nested.a === true;
  }, 'testData');

  assert('CSV ìƒì„± (ì—‘ì…€ ë‚´ë³´ë‚´ê¸°)', () => {
    const headers = 'ì´ë¦„,ì—°ë½ì²˜,ë“±ê¸‰\n';
    const rows = 'ê¹€ì² ìˆ˜,010-1234-5678,VIP\nì´ì˜í¬,010-9876-5432,ìš°ìˆ˜\n';
    const csv = '\uFEFF' + headers + rows;
    return csv.includes('\uFEFF') && csv.includes('ê¹€ì² ìˆ˜');
  }, 'testData');

  assert('JSON ë°±ì—… ë°ì´í„° êµ¬ì¡°', () => {
    let data;
    try { data = JSON.parse(localStorage.getItem('udb6')) || {}; } catch { data = {}; }
    const backup = JSON.stringify({ customers: data.customers||[], stores: data.stores||[], brands: data.brands||[] });
    const parsed = JSON.parse(backup);
    return Array.isArray(parsed.customers) && Array.isArray(parsed.stores) && Array.isArray(parsed.brands);
  }, 'testData');

  assert('ë‚ ì§œ í•„í„°ë§ ë¡œì§', () => {
    const d = new Date();
    const td = d.toISOString().slice(0,10);
    const yd = new Date(d - 86400000).toISOString().slice(0,10);
    const items = [{createdAt:td},{createdAt:yd}];
    const filtered = items.filter(i => i.createdAt === td);
    return filtered.length === 1;
  }, 'testData');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//   9. UI/UX í…ŒìŠ¤íŠ¸
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function testUIUX() {
  log('â”€â”€ UI/UX í…ŒìŠ¤íŠ¸ â”€â”€', 'info');

  assert('7ê°œ íƒ­ ì •ì˜', () => {
    const tabs = ['dash','smart','search','cust','store','brand','set'];
    return tabs.length === 7;
  }, 'testUI');

  assert('ë“±ê¸‰ ë±ƒì§€ ìƒ‰ìƒ ë§¤í•‘', () => {
    const gradeColors = { VIP:'#C0392B', ìš°ìˆ˜:'#E65100', ì¼ë°˜:'#666', ì‹ ê·œ:'#1565C0', íœ´ë©´:'#999' };
    return Object.keys(gradeColors).length === 5;
  }, 'testUI');

  assert('ìƒíƒœ ë±ƒì§€ í´ë˜ìŠ¤ ë§¤í•‘', () => {
    const cls = {'ì‹ ê·œ':'st-new','ìƒë‹´ì¤‘':'st-consult','ê³„ì•½ì§„í–‰':'st-contract','ê³„ì•½ì™„ë£Œ':'st-done','ì´íƒˆ':'st-lost'};
    return Object.keys(cls).length === 5;
  }, 'testUI');

  assert('ë°˜ì‘í˜• ë¯¸ë””ì–´ì¿¼ë¦¬ ì¡´ì¬', () => {
    // 900px ê¸°ì¤€ í…ŒìŠ¤íŠ¸
    return window.matchMedia !== undefined;
  }, 'testUI');

  assert('Clipboard API ê°€ìš©ì„±', () => {
    return navigator.clipboard !== undefined || document.execCommand !== undefined;
  }, 'testUI');

  assert('Web Speech API ê°€ìš©ì„±', () => {
    return window.SpeechRecognition !== undefined || window.webkitSpeechRecognition !== undefined;
  }, 'testUI');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//   í…ŒìŠ¤íŠ¸ ë°ì´í„° ì£¼ì…
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function injectTestData() {
  if (!confirm('í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì£¼ì…í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nê¸°ì¡´ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ì¶”ê°€ë©ë‹ˆë‹¤.')) return;

  let data;
  try { data = JSON.parse(localStorage.getItem('udb6')) || {}; } catch { data = {}; }
  if (!data.customers) data.customers = [];
  if (!data.stores) data.stores = [];
  if (!data.brands) data.brands = [];

  // í…ŒìŠ¤íŠ¸ ê³ ê° 10ëª…
  const testCustomers = [
    {id:'test_c1',name:'ê¹€ì² ìˆ˜',phone:'010-1234-5678',grade:'VIP',status:'ìƒë‹´ì¤‘',region:'ê°•ë‚¨',budget:'1ì–µ2ì²œë§Œ',bizType:'ì¹´í˜',wantArea:'20~35í‰',interests:'ë§˜ìŠ¤í„°ì¹˜, ë¹½ë‹¤ë°©',dbCat:'ì°¨ì•Œ DB',tags:['#ê¸‰ë§¤','#ê´€ì‹¬ë†’ìŒ'],memos:[{text:'ê°•ë‚¨ ì„ í˜¸, ì˜ˆì‚° í˜‘ì˜ ê°€ëŠ¥',date:today()}],consultHistory:[{date:today(),content:'ì´ˆê¸°ìƒë‹´',result:'ê´€ì‹¬ë†’ìŒ',type:'ì „í™”'}],activityLog:[],createdAt:today()},
    {id:'test_c2',name:'ì´ì˜í¬',phone:'010-9876-5432',grade:'ìš°ìˆ˜',status:'ì œì•ˆì™„ë£Œ',region:'ì„œì´ˆ',budget:'8ì²œë§Œ',bizType:'ì¹˜í‚¨',wantArea:'15~20í‰',interests:'BBQ, êµì´Œ',dbCat:'ë‚´ì¼ì‚¬ì¥ DB',tags:['#ì„œì´ˆ'],memos:[],consultHistory:[],activityLog:[],createdAt:today()},
    {id:'test_c3',name:'ë°•ë¯¼ìˆ˜',phone:'010-5555-1234',grade:'ì¼ë°˜',status:'ì‹ ê·œ',region:'ë§ˆí¬',budget:'5ì²œë§Œ',bizType:'ë¶„ì‹',wantArea:'10~15í‰',interests:'',dbCat:'ì°¨ì•Œ DB',tags:[],memos:[],consultHistory:[],activityLog:[],createdAt:today()},
    {id:'test_c4',name:'ì •ë‹¤ìš´',phone:'010-3333-4444',grade:'VIP',status:'ê³„ì•½ì§„í–‰',region:'ì†¡íŒŒ',budget:'2ì–µ',bizType:'ì‚¼ê²¹ì‚´',wantArea:'30~40í‰',interests:'',dbCat:'ë‚´ì¼ì‚¬ì¥ DB',tags:['#ëŒ€í˜•','#VIP'],memos:[{text:'ëŒ€í˜• ë§¤ì¥ ì„ í˜¸',date:today()}],consultHistory:[],activityLog:[],createdAt:today()},
    {id:'test_c5',name:'ìµœì„œì—°',phone:'010-7777-8888',grade:'ì‹ ê·œ',status:'ì‹ ê·œ',region:'ê°•ì„œ',budget:'3ì²œë§Œ',bizType:'ë² ì´ì»¤ë¦¬',wantArea:'15í‰',interests:'íŒŒë¦¬ë°”ê²Œëœ¨',dbCat:'',tags:[],memos:[],consultHistory:[],activityLog:[],createdAt:today()},
    {id:'test_c6',name:'í•œì§€ë¯¼',phone:'010-1111-2222',grade:'ìš°ìˆ˜',status:'ìƒë‹´ì¤‘',region:'ìš©ì‚°',budget:'1ì–µ',bizType:'ì¹´í˜',wantArea:'25í‰',interests:'ìŠ¤íƒ€ë²…ìŠ¤, ë©”ê°€ì»¤í”¼',dbCat:'ì°¨ì•Œ DB',tags:['#ê¸‰ë§¤'],memos:[],consultHistory:[{date:today(),content:'2ì°¨ ìƒë‹´',result:'ê¸ì •ì ',type:'ë°©ë¬¸'}],activityLog:[],createdAt:today()},
    {id:'test_c7',name:'ìœ¤ì„œì¤€',phone:'010-4444-5555',grade:'ì¼ë°˜',status:'ë³´ë¥˜',region:'ì„±ë¶',budget:'6ì²œë§Œ',bizType:'í¸ì˜ì ',wantArea:'10í‰',interests:'CU, GS25',dbCat:'',tags:[],memos:[{text:'3ê°œì›” í›„ ì¬ì—°ë½',date:today()}],consultHistory:[],activityLog:[],createdAt:today()},
    {id:'test_c8',name:'ê°•ë¯¼í˜¸',phone:'010-6666-7777',grade:'VIP',status:'ê³„ì•½ì™„ë£Œ',region:'ê°•ë‚¨',budget:'3ì–µ',bizType:'ë ˆìŠ¤í† ë‘',wantArea:'50í‰ ì´ìƒ',interests:'',dbCat:'ë‚´ì¼ì‚¬ì¥ DB',tags:['#ì™„ë£Œ'],memos:[],consultHistory:[],activityLog:[],createdAt:today()},
    {id:'test_c9',name:'ì„œí•˜ì€',phone:'010-8888-9999',grade:'íœ´ë©´',status:'ì´íƒˆ',region:'ë…¸ì›',budget:'',bizType:'',wantArea:'',interests:'',dbCat:'',tags:[],memos:[],consultHistory:[],activityLog:[],createdAt:today()},
    {id:'test_c10',name:'ì„ë„í˜„',phone:'010-2222-3333',grade:'ì‹ ê·œ',status:'ì‹ ê·œ',region:'ì˜ë“±í¬',budget:'7ì²œë§Œ',bizType:'ë–¡ë³¶ì´',wantArea:'12í‰',interests:'ì‹ ì „ë–¡ë³¶ì´',dbCat:'ì°¨ì•Œ DB',tags:['#ì‹ ê·œ'],memos:[],consultHistory:[],activityLog:[],createdAt:today()}
  ];

  // í…ŒìŠ¤íŠ¸ ì í¬ 5ê°œ
  const testStores = [
    {id:'test_s1',name:'ê°•ë‚¨ì—­ 2ë²ˆì¶œêµ¬ 1ì¸µ',address:'ì„œìš¸ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ 123-4',district:'ê°•ë‚¨êµ¬',floor:'1ì¸µ',area:'35',rent:'350ë§Œ',maintenance:'30ë§Œ',deposit:'5ì²œë§Œ',premium:'8ì²œë§Œ',grade:'Aê¸‰',status:'ê³µì‹¤',dbCat:'ë‚´ì¼ì‚¬ì¥DB',marketRent:'300ë§Œ',marketDeposit:'4500ë§Œ',tags:['#ì—­ì„¸ê¶Œ','#ì½”ë„ˆ'],photos:[],files:[],memos:[{text:'ëŒ€ë¡œë³€ ì½”ë„ˆ, ìœ ë™ì¸êµ¬ ë§ìŒ',date:today()}],activityLog:[],createdAt:today()},
    {id:'test_s2',name:'ì„œì´ˆë™ ì‚¬ê±°ë¦¬ B1',address:'ì„œìš¸ ì„œì´ˆêµ¬ ì„œì´ˆë™ 456-7',district:'ì„œì´ˆêµ¬',floor:'B1',area:'25',rent:'200ë§Œ',maintenance:'20ë§Œ',deposit:'3ì²œë§Œ',premium:'5ì²œë§Œ',grade:'Bê¸‰',status:'ì†Œê°œì¤‘',dbCat:'ì›ìœŒì•¤ì½”DB',marketRent:'250ë§Œ',marketDeposit:'3500ë§Œ',tags:['#ì§€í•˜'],photos:[],files:[],memos:[],activityLog:[],createdAt:today()},
    {id:'test_s3',name:'í™ëŒ€ì…êµ¬ ë©”ì¸ë¡œ 2ì¸µ',address:'ì„œìš¸ ë§ˆí¬êµ¬ ì„œêµë™ 789-0',district:'ë§ˆí¬êµ¬',floor:'2ì¸µ',area:'42',rent:'500ë§Œ',maintenance:'50ë§Œ',deposit:'1ì–µ',premium:'1ì–µ2ì²œë§Œ',grade:'Aê¸‰',status:'ê³„ì•½ì§„í–‰',dbCat:'ë‚´ì¼ì‚¬ì¥DB',marketRent:'480ë§Œ',marketDeposit:'9ì²œë§Œ',tags:['#ëŒ€í˜•','#ë©”ì¸ë¡œ'],photos:[],files:[],memos:[],activityLog:[],createdAt:today()},
    {id:'test_s4',name:'ì†¡íŒŒ ì„ì´Œí˜¸ìˆ˜ ì•',address:'ì„œìš¸ ì†¡íŒŒêµ¬ ì„ì´Œë™ 111-2',district:'ì†¡íŒŒêµ¬',floor:'1ì¸µ',area:'18',rent:'180ë§Œ',maintenance:'15ë§Œ',deposit:'2ì²œë§Œ',premium:'3ì²œë§Œ',grade:'Cê¸‰',status:'ê³µì‹¤',dbCat:'ì°½ì—…ì›DB',marketRent:'200ë§Œ',marketDeposit:'2500ë§Œ',tags:[],photos:[],files:[],memos:[],activityLog:[],createdAt:today()},
    {id:'test_s5',name:'ì ì‹¤ ë¡¯ë°ì›”ë“œíƒ€ì›Œ ì•',address:'ì„œìš¸ ì†¡íŒŒêµ¬ ì ì‹¤ë™ 333-4',district:'ì†¡íŒŒêµ¬',floor:'1ì¸µ',area:'55',rent:'800ë§Œ',maintenance:'80ë§Œ',deposit:'2ì–µ',premium:'3ì–µ',grade:'Aê¸‰',status:'ì†Œê°œì¤‘',dbCat:'ë‚´ì¼ì‚¬ì¥DB',marketRent:'750ë§Œ',marketDeposit:'1ì–µ8ì²œë§Œ',tags:['#í”„ë¦¬ë¯¸ì—„','#ëŒ€ë¡œë³€'],photos:[],files:[],memos:[],activityLog:[],createdAt:today()}
  ];

  // í…ŒìŠ¤íŠ¸ ë¸Œëœë“œ 3ê°œ
  const testBrands = [
    {id:'test_b1',brandName:'ë§˜ìŠ¤í„°ì¹˜',companyName:'(ì£¼)ë§˜ìŠ¤í„°ì¹˜ì•¤ì»´í¼ë‹ˆ',contactName:'ì´ë¶€ì¥',position:'ë¶€ì¥',phone:'010-5555-1234',consultContent:'ê°€ë§¹ì¡°ê±´ ë¬¸ì˜, ê°€ë§¹ë¹„ 3ì²œë§Œ, ë¡œì—´í‹° ì›” 40ë§Œ',tags:['#ë²„ê±°'],memos:[],createdAt:today()},
    {id:'test_b2',brandName:'ë¹½ë‹¤ë°©',companyName:'ë”ë³¸ì½”ë¦¬ì•„',contactName:'ê¹€ì°¨ì¥',position:'ì°¨ì¥',phone:'010-6666-5432',consultContent:'ì†Œê·œëª¨ ì°½ì—… ê°€ëŠ¥, ê°€ë§¹ë¹„ 1ì²œë§Œ',tags:['#ì¹´í˜','#ì†Œìë³¸'],memos:[],createdAt:today()},
    {id:'test_b3',brandName:'BBQì¹˜í‚¨',companyName:'(ì£¼)ì œë„ˆì‹œìŠ¤BBQ',contactName:'ë°•íŒ€ì¥',position:'íŒ€ì¥',phone:'010-7777-6789',consultContent:'ê°€ë§¹ë¬¸ì˜, ì°½ì—…ë¹„ìš© 1ì–µ5ì²œë§Œ ì˜ˆìƒ',tags:['#ì¹˜í‚¨'],memos:[],createdAt:today()}
  ];

  // ê¸°ì¡´ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì œê±° í›„ ì¶”ê°€
  data.customers = data.customers.filter(c => !c.id.startsWith('test_'));
  data.stores = data.stores.filter(s => !s.id.startsWith('test_'));
  data.brands = data.brands.filter(b => !b.id.startsWith('test_'));

  data.customers.push(...testCustomers);
  data.stores.push(...testStores);
  data.brands.push(...testBrands);

  localStorage.setItem('udb6', JSON.stringify(data));
  alert('âœ… í…ŒìŠ¤íŠ¸ ë°ì´í„° ì£¼ì… ì™„ë£Œ!\n\nê³ ê° 10ëª… + ì í¬ 5ê°œ + ë¸Œëœë“œ 3ê°œ\n\nì•±ì—ì„œ í™•ì¸í•˜ì„¸ìš”.');
  log('ğŸ“¥ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì£¼ì…: ê³ ê° 10ëª…, ì í¬ 5ê°œ, ë¸Œëœë“œ 3ê°œ', 'ok');
}

function clearTestData() {
  if (!confirm('í…ŒìŠ¤íŠ¸ ë°ì´í„°ë§Œ ì‚­ì œí•©ë‹ˆë‹¤ (IDê°€ test_ë¡œ ì‹œì‘í•˜ëŠ” ë°ì´í„°). ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

  let data;
  try { data = JSON.parse(localStorage.getItem('udb6')) || {}; } catch { data = {}; }

  const cBefore = (data.customers||[]).length;
  const sBefore = (data.stores||[]).length;
  const bBefore = (data.brands||[]).length;

  data.customers = (data.customers||[]).filter(c => !c.id.startsWith('test_'));
  data.stores = (data.stores||[]).filter(s => !s.id.startsWith('test_'));
  data.brands = (data.brands||[]).filter(b => !b.id.startsWith('test_'));

  localStorage.setItem('udb6', JSON.stringify(data));

  const cDel = cBefore - data.customers.length;
  const sDel = sBefore - data.stores.length;
  const bDel = bBefore - data.brands.length;

  alert(`âœ… í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚­ì œ ì™„ë£Œ!\n\nê³ ê° ${cDel}ê±´, ì í¬ ${sDel}ê±´, ë¸Œëœë“œ ${bDel}ê±´ ì‚­ì œ`);
  log(`ğŸ—‘ï¸ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚­ì œ: ê³ ê° ${cDel}, ì í¬ ${sDel}, ë¸Œëœë“œ ${bDel}`, 'warn');
}
</script>
</body>
</html>
